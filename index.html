<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Margaux Thieury">
<meta name="dcterms.date" content="2025-11-24">

<title>Enregistrements acoustiques 2025 dans la RNCFS de Belledonne</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="main_files/libs/clipboard/clipboard.min.js"></script>
<script src="main_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="main_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="main_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="main_files/libs/quarto-html/popper.min.js"></script>
<script src="main_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="main_files/libs/quarto-html/anchor.min.js"></script>
<link href="main_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="main_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="main_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="main_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="main_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="main_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="main_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="main_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Enregistrements acoustiques 2025 dans la RNCFS de Belledonne</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Margaux Thieury </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">11/24/25</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="la-pose-des-enregistreurs-audiomoth-et-la-météo-sur-belledonne" class="level2">
<h2 class="anchored" data-anchor-id="la-pose-des-enregistreurs-audiomoth-et-la-météo-sur-belledonne">La pose des enregistreurs audiomoth et la météo sur Belledonne</h2>
<p>Durant l’été 2025, 32 enregistreurs de type audiomoth ont été posé dans la RNCFS de Belledonne. Leur emplacement est visble sur la carte ci-dessous Figure 1. (point cliquable pour connaitre le nom de l’enregistreur)</p>
<div id="map">
<div id="7974ddf0" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="3">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -&gt; Trust Notebook</span><iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_3b24de28d0fd7fa0a17a4d71537f2f0c {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
</head>
<body>
    
    
<div style=&quot;
    position: fixed; 
    bottom: 50px; left: 50px; width: 150px; height: 90px; 
    z-index:9999; font-size:14px; color:white;
    &quot;>
    <b>Légende</b><br>
    <i class=&quot;fa fa-circle&quot; style=&quot;color:green&quot;></i> Pelouse sèche<br>
    <i class=&quot;fa fa-circle&quot; style=&quot;color:blue&quot;></i> Lande fraîche<br>
</div>
    
            <div class=&quot;folium-map&quot; id=&quot;map_3b24de28d0fd7fa0a17a4d71537f2f0c&quot; ></div>
        
</body>
<script>
    
    
            var map_3b24de28d0fd7fa0a17a4d71537f2f0c = L.map(
                &quot;map_3b24de28d0fd7fa0a17a4d71537f2f0c&quot;,
                {
                    center: [45.215862625, 6.1169473687187494],
                    crs: L.CRS.EPSG3857,
                    ...{
  &quot;zoom&quot;: 13,
  &quot;zoomControl&quot;: true,
  &quot;preferCanvas&quot;: false,
}

                }
            );

            

        
    
            var tile_layer_f21c899512e9b74a022e0695a3662ab3 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {
  &quot;minZoom&quot;: 0,
  &quot;maxZoom&quot;: 19,
  &quot;maxNativeZoom&quot;: 19,
  &quot;noWrap&quot;: false,
  &quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;,
  &quot;subdomains&quot;: &quot;abc&quot;,
  &quot;detectRetina&quot;: false,
  &quot;tms&quot;: false,
  &quot;opacity&quot;: 1,
}

            );
        
    
            tile_layer_f21c899512e9b74a022e0695a3662ab3.addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
            var tile_layer_fc4db0bb07ed91a9a4845de2a286600a = L.tileLayer(
                &quot;https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}&quot;,
                {
  &quot;minZoom&quot;: 0,
  &quot;maxZoom&quot;: 18,
  &quot;maxNativeZoom&quot;: 18,
  &quot;noWrap&quot;: false,
  &quot;attribution&quot;: &quot;Esri World Imagery&quot;,
  &quot;subdomains&quot;: &quot;abc&quot;,
  &quot;detectRetina&quot;: false,
  &quot;tms&quot;: false,
  &quot;opacity&quot;: 1,
}

            );
        
    
            tile_layer_fc4db0bb07ed91a9a4845de2a286600a.addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
            var circle_marker_7dcc557c1d96d351d28864775c5821ea = L.circleMarker(
                [45.21207417, 6.095794383],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_c9c14fbfb10c1af7125ef52e3d397a29 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_b88aa5f081cd0a30b63fd67ae45519c4 = $(`<div id=&quot;html_b88aa5f081cd0a30b63fd67ae45519c4&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: CH17<br></div>`)[0];
                popup_c9c14fbfb10c1af7125ef52e3d397a29.setContent(html_b88aa5f081cd0a30b63fd67ae45519c4);
            
        

        circle_marker_7dcc557c1d96d351d28864775c5821ea.bindPopup(popup_c9c14fbfb10c1af7125ef52e3d397a29)
        ;

        
    
    
            var circle_marker_5b4a5c3b63f7219849e25f0064c522bb = L.circleMarker(
                [45.21444744, 6.096619178],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_f425adf16bd0ef7cc136e22238b8c2dc = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e803b724e4b595767c4f674b07baa852 = $(`<div id=&quot;html_e803b724e4b595767c4f674b07baa852&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I12<br></div>`)[0];
                popup_f425adf16bd0ef7cc136e22238b8c2dc.setContent(html_e803b724e4b595767c4f674b07baa852);
            
        

        circle_marker_5b4a5c3b63f7219849e25f0064c522bb.bindPopup(popup_f425adf16bd0ef7cc136e22238b8c2dc)
        ;

        
    
    
            var circle_marker_0c2658c94141f65dd40053b3fa49aca6 = L.circleMarker(
                [45.21272038, 6.100356001],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_ca11688df0b73c92d1d0650f83a91ff3 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_f90d6a67679a05c48a86f0982bcfd017 = $(`<div id=&quot;html_f90d6a67679a05c48a86f0982bcfd017&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: AM09<br></div>`)[0];
                popup_ca11688df0b73c92d1d0650f83a91ff3.setContent(html_f90d6a67679a05c48a86f0982bcfd017);
            
        

        circle_marker_0c2658c94141f65dd40053b3fa49aca6.bindPopup(popup_ca11688df0b73c92d1d0650f83a91ff3)
        ;

        
    
    
            var circle_marker_fd04346131b705f26f4f7785a0fe328d = L.circleMarker(
                [45.21281543, 6.10040294],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_73de5e804538a06801c5679d0160a255 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_43bcf8f1882a2ad561de28e7b30c4f5c = $(`<div id=&quot;html_43bcf8f1882a2ad561de28e7b30c4f5c&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I07<br></div>`)[0];
                popup_73de5e804538a06801c5679d0160a255.setContent(html_43bcf8f1882a2ad561de28e7b30c4f5c);
            
        

        circle_marker_fd04346131b705f26f4f7785a0fe328d.bindPopup(popup_73de5e804538a06801c5679d0160a255)
        ;

        
    
    
            var circle_marker_2853c03007e2cabd96bceee64e221394 = L.circleMarker(
                [45.21866932, 6.133361726],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_6776d2788bc44a7e76401997b740b7e8 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_933042789b33f798f626b08c9ad4da9c = $(`<div id=&quot;html_933042789b33f798f626b08c9ad4da9c&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: AM02<br></div>`)[0];
                popup_6776d2788bc44a7e76401997b740b7e8.setContent(html_933042789b33f798f626b08c9ad4da9c);
            
        

        circle_marker_2853c03007e2cabd96bceee64e221394.bindPopup(popup_6776d2788bc44a7e76401997b740b7e8)
        ;

        
    
    
            var circle_marker_04cb2ed2beb947dab57a956a0d73a0da = L.circleMarker(
                [45.21518255, 6.129357805],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_a6d4b29840a3947c9c7ac9dfa78eb1c2 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_361376448ee1908899c23b4b1f30f627 = $(`<div id=&quot;html_361376448ee1908899c23b4b1f30f627&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I10<br></div>`)[0];
                popup_a6d4b29840a3947c9c7ac9dfa78eb1c2.setContent(html_361376448ee1908899c23b4b1f30f627);
            
        

        circle_marker_04cb2ed2beb947dab57a956a0d73a0da.bindPopup(popup_a6d4b29840a3947c9c7ac9dfa78eb1c2)
        ;

        
    
    
            var circle_marker_12b35f8257a3ea7d1479828e86b15a60 = L.circleMarker(
                [45.21466606, 6.128253535],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_979bc5da9a9f7d661a02f20bec74b815 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_bedbd02535d110abcf289131fe77949a = $(`<div id=&quot;html_bedbd02535d110abcf289131fe77949a&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I14<br></div>`)[0];
                popup_979bc5da9a9f7d661a02f20bec74b815.setContent(html_bedbd02535d110abcf289131fe77949a);
            
        

        circle_marker_12b35f8257a3ea7d1479828e86b15a60.bindPopup(popup_979bc5da9a9f7d661a02f20bec74b815)
        ;

        
    
    
            var circle_marker_83b83901a09c657703fba12435cce2de = L.circleMarker(
                [45.212241, 6.125280306],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_db8950f2ff8b990ceabdff9b3a014844 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_a93e7793573d7cd783ef444a71dde3ee = $(`<div id=&quot;html_a93e7793573d7cd783ef444a71dde3ee&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I27<br></div>`)[0];
                popup_db8950f2ff8b990ceabdff9b3a014844.setContent(html_a93e7793573d7cd783ef444a71dde3ee);
            
        

        circle_marker_83b83901a09c657703fba12435cce2de.bindPopup(popup_db8950f2ff8b990ceabdff9b3a014844)
        ;

        
    
    
            var circle_marker_4496921557fd3cd06a822e8a08d0dd19 = L.circleMarker(
                [45.21151161, 6.124254037],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_7afb0ef476d2a67b2643b81b0dc9d928 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_8aadba8264479b6b6c3a9f66ddd8a884 = $(`<div id=&quot;html_8aadba8264479b6b6c3a9f66ddd8a884&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I20<br></div>`)[0];
                popup_7afb0ef476d2a67b2643b81b0dc9d928.setContent(html_8aadba8264479b6b6c3a9f66ddd8a884);
            
        

        circle_marker_4496921557fd3cd06a822e8a08d0dd19.bindPopup(popup_7afb0ef476d2a67b2643b81b0dc9d928)
        ;

        
    
    
            var circle_marker_ede4b866fdb55778cb12c53cd5409318 = L.circleMarker(
                [45.21699119, 6.119832302],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_79b10b7320e19d02644c4e4fc2e7eff9 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_0880a556d60a68bbad06aad33a3caad1 = $(`<div id=&quot;html_0880a556d60a68bbad06aad33a3caad1&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I26<br></div>`)[0];
                popup_79b10b7320e19d02644c4e4fc2e7eff9.setContent(html_0880a556d60a68bbad06aad33a3caad1);
            
        

        circle_marker_ede4b866fdb55778cb12c53cd5409318.bindPopup(popup_79b10b7320e19d02644c4e4fc2e7eff9)
        ;

        
    
    
            var circle_marker_44d2b306d14d134b6c516953978c7187 = L.circleMarker(
                [45.2120379, 6.105674651],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_b63406f8935bf6e2929a2bcd3df88541 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_f39972a91edfca7bd6aa047918039c85 = $(`<div id=&quot;html_f39972a91edfca7bd6aa047918039c85&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I4<br></div>`)[0];
                popup_b63406f8935bf6e2929a2bcd3df88541.setContent(html_f39972a91edfca7bd6aa047918039c85);
            
        

        circle_marker_44d2b306d14d134b6c516953978c7187.bindPopup(popup_b63406f8935bf6e2929a2bcd3df88541)
        ;

        
    
    
            var circle_marker_c4d18391e9d054c3c44bf9be01aa7627 = L.circleMarker(
                [45.21193497, 6.105692581],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_311393c63ee7d405a9d821c9f21c1b41 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_ae876eebee7e62accd454cab4d25c22e = $(`<div id=&quot;html_ae876eebee7e62accd454cab4d25c22e&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: CH12<br></div>`)[0];
                popup_311393c63ee7d405a9d821c9f21c1b41.setContent(html_ae876eebee7e62accd454cab4d25c22e);
            
        

        circle_marker_c4d18391e9d054c3c44bf9be01aa7627.bindPopup(popup_311393c63ee7d405a9d821c9f21c1b41)
        ;

        
    
    
            var circle_marker_dea04c389be932e86c8ee9e32df65b35 = L.circleMarker(
                [45.21210615, 6.105555589],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_9de4df7f75f9cb884125cdc241647c02 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_c44eb81389540d5597b5df6e6bd4ace7 = $(`<div id=&quot;html_c44eb81389540d5597b5df6e6bd4ace7&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: CH10<br></div>`)[0];
                popup_9de4df7f75f9cb884125cdc241647c02.setContent(html_c44eb81389540d5597b5df6e6bd4ace7);
            
        

        circle_marker_dea04c389be932e86c8ee9e32df65b35.bindPopup(popup_9de4df7f75f9cb884125cdc241647c02)
        ;

        
    
    
            var circle_marker_f3688df42ae8e703ae516581eb480183 = L.circleMarker(
                [45.21225658, 6.105664279],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_c5194bb7f21ef968f6d4593d39cfb6ab = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_54847e7f41342bec6f792fd8d8f7aa91 = $(`<div id=&quot;html_54847e7f41342bec6f792fd8d8f7aa91&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I19<br></div>`)[0];
                popup_c5194bb7f21ef968f6d4593d39cfb6ab.setContent(html_54847e7f41342bec6f792fd8d8f7aa91);
            
        

        circle_marker_f3688df42ae8e703ae516581eb480183.bindPopup(popup_c5194bb7f21ef968f6d4593d39cfb6ab)
        ;

        
    
    
            var circle_marker_5c1a58c21a48f2cbb9ddd68a857bd0b9 = L.circleMarker(
                [45.21285173, 6.103917918],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_7d66ee026c8c7a373a14836a9e02d669 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_653551ef2dcd7085dbb38dbbf21765ef = $(`<div id=&quot;html_653551ef2dcd7085dbb38dbbf21765ef&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I16<br></div>`)[0];
                popup_7d66ee026c8c7a373a14836a9e02d669.setContent(html_653551ef2dcd7085dbb38dbbf21765ef);
            
        

        circle_marker_5c1a58c21a48f2cbb9ddd68a857bd0b9.bindPopup(popup_7d66ee026c8c7a373a14836a9e02d669)
        ;

        
    
    
            var circle_marker_0753060f70c49c6ab48da6add88f6fa8 = L.circleMarker(
                [45.21325185, 6.103967848],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_6c90ec4633891221f838840d47162281 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e6416f587cd02416e0f2f9a00c00a8aa = $(`<div id=&quot;html_e6416f587cd02416e0f2f9a00c00a8aa&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I9<br></div>`)[0];
                popup_6c90ec4633891221f838840d47162281.setContent(html_e6416f587cd02416e0f2f9a00c00a8aa);
            
        

        circle_marker_0753060f70c49c6ab48da6add88f6fa8.bindPopup(popup_6c90ec4633891221f838840d47162281)
        ;

        
    
    
            var circle_marker_0f68660b18ed3f8a63931175d42601ee = L.circleMarker(
                [45.21351532, 6.104899413],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_4be9b8f994e49cd200cc309c490847f6 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_49410fb451ccf64bb2605942eeae31ce = $(`<div id=&quot;html_49410fb451ccf64bb2605942eeae31ce&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: CH20<br></div>`)[0];
                popup_4be9b8f994e49cd200cc309c490847f6.setContent(html_49410fb451ccf64bb2605942eeae31ce);
            
        

        circle_marker_0f68660b18ed3f8a63931175d42601ee.bindPopup(popup_4be9b8f994e49cd200cc309c490847f6)
        ;

        
    
    
            var circle_marker_afc6b702df6938491cf2699638e1dd98 = L.circleMarker(
                [45.21351509, 6.104899277],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_6df3df4176529a96175d57feedac4b89 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_4ad6984ae15e0327c3ef3e8c201ce772 = $(`<div id=&quot;html_4ad6984ae15e0327c3ef3e8c201ce772&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: CH14<br></div>`)[0];
                popup_6df3df4176529a96175d57feedac4b89.setContent(html_4ad6984ae15e0327c3ef3e8c201ce772);
            
        

        circle_marker_afc6b702df6938491cf2699638e1dd98.bindPopup(popup_6df3df4176529a96175d57feedac4b89)
        ;

        
    
    
            var circle_marker_02b657a00f4d7c3c5a2e960bc149c89b = L.circleMarker(
                [45.21215691, 6.106813697],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_8ac04ee499c4afdcd20ebbceb8d464ad = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_b1678cf079fee83834b7e185f3bfa96e = $(`<div id=&quot;html_b1678cf079fee83834b7e185f3bfa96e&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I30<br></div>`)[0];
                popup_8ac04ee499c4afdcd20ebbceb8d464ad.setContent(html_b1678cf079fee83834b7e185f3bfa96e);
            
        

        circle_marker_02b657a00f4d7c3c5a2e960bc149c89b.bindPopup(popup_8ac04ee499c4afdcd20ebbceb8d464ad)
        ;

        
    
    
            var circle_marker_386168152dc5ffa23e66f886c11c5850 = L.circleMarker(
                [45.222595, 6.136635],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_51ccb1ce553944839786e88f0b55ff90 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_1fb8698622e5fbf3737b00299899263e = $(`<div id=&quot;html_1fb8698622e5fbf3737b00299899263e&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I21<br></div>`)[0];
                popup_51ccb1ce553944839786e88f0b55ff90.setContent(html_1fb8698622e5fbf3737b00299899263e);
            
        

        circle_marker_386168152dc5ffa23e66f886c11c5850.bindPopup(popup_51ccb1ce553944839786e88f0b55ff90)
        ;

        
    
    
            var circle_marker_c5ddf216c244e491f2d1461ce78de11c = L.circleMarker(
                [45.22126167, 6.134628333],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_61b3f58f5fb2073bec2736a211373442 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_dd9f7560ff28ba17d81b9191736ce986 = $(`<div id=&quot;html_dd9f7560ff28ba17d81b9191736ce986&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I6<br></div>`)[0];
                popup_61b3f58f5fb2073bec2736a211373442.setContent(html_dd9f7560ff28ba17d81b9191736ce986);
            
        

        circle_marker_c5ddf216c244e491f2d1461ce78de11c.bindPopup(popup_61b3f58f5fb2073bec2736a211373442)
        ;

        
    
    
            var circle_marker_a7f23cc2832c2dedf37b569676a50cc4 = L.circleMarker(
                [45.22171667, 6.133871667],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_415631eeff875af7efd09a9ddd2598e8 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_a6167570945c7f27b258c059ad39a070 = $(`<div id=&quot;html_a6167570945c7f27b258c059ad39a070&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: AM04<br></div>`)[0];
                popup_415631eeff875af7efd09a9ddd2598e8.setContent(html_a6167570945c7f27b258c059ad39a070);
            
        

        circle_marker_a7f23cc2832c2dedf37b569676a50cc4.bindPopup(popup_415631eeff875af7efd09a9ddd2598e8)
        ;

        
    
    
            var circle_marker_45cb4228032254787485eb2cf0c0756e = L.circleMarker(
                [45.22188667, 6.132923333],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_347025a327e309a468f86084edd8a011 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_6242ee9c9d631414f83dbd38eee928be = $(`<div id=&quot;html_6242ee9c9d631414f83dbd38eee928be&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I25<br></div>`)[0];
                popup_347025a327e309a468f86084edd8a011.setContent(html_6242ee9c9d631414f83dbd38eee928be);
            
        

        circle_marker_45cb4228032254787485eb2cf0c0756e.bindPopup(popup_347025a327e309a468f86084edd8a011)
        ;

        
    
    
            var circle_marker_17d053d6d7446cb0549014e746b911c0 = L.circleMarker(
                [45.21977, 6.129935],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_4eb69329551dca91dd3ea022e589496f = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_e7425895aa30c7dfb83775c35369a151 = $(`<div id=&quot;html_e7425895aa30c7dfb83775c35369a151&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I1<br></div>`)[0];
                popup_4eb69329551dca91dd3ea022e589496f.setContent(html_e7425895aa30c7dfb83775c35369a151);
            
        

        circle_marker_17d053d6d7446cb0549014e746b911c0.bindPopup(popup_4eb69329551dca91dd3ea022e589496f)
        ;

        
    
    
            var circle_marker_ac647391d788458ef908cd4cbdd5bbd3 = L.circleMarker(
                [45.22043667, 6.130751667],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_164780aff04cc8f466267578365c2d53 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_c939d129bb808b15bff1c872646da567 = $(`<div id=&quot;html_c939d129bb808b15bff1c872646da567&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I8<br></div>`)[0];
                popup_164780aff04cc8f466267578365c2d53.setContent(html_c939d129bb808b15bff1c872646da567);
            
        

        circle_marker_ac647391d788458ef908cd4cbdd5bbd3.bindPopup(popup_164780aff04cc8f466267578365c2d53)
        ;

        
    
    
            var circle_marker_a71d2aa0faac093f4e5d956e216c82f6 = L.circleMarker(
                [45.218095, 6.124345],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_f083acca10fe1d5e9c9445940f11f331 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_61718947ff4bb90b9e6d89a42e705606 = $(`<div id=&quot;html_61718947ff4bb90b9e6d89a42e705606&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I29<br></div>`)[0];
                popup_f083acca10fe1d5e9c9445940f11f331.setContent(html_61718947ff4bb90b9e6d89a42e705606);
            
        

        circle_marker_a71d2aa0faac093f4e5d956e216c82f6.bindPopup(popup_f083acca10fe1d5e9c9445940f11f331)
        ;

        
    
    
            var circle_marker_5b0b2310e9e858c4225b4c0ef4da4de0 = L.circleMarker(
                [45.21647, 6.112185],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_bcffd1706bf852de7ef65570a4cd9678 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_15a902b9eda7f8af0da000a5a9a15c76 = $(`<div id=&quot;html_15a902b9eda7f8af0da000a5a9a15c76&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: AM08<br></div>`)[0];
                popup_bcffd1706bf852de7ef65570a4cd9678.setContent(html_15a902b9eda7f8af0da000a5a9a15c76);
            
        

        circle_marker_5b0b2310e9e858c4225b4c0ef4da4de0.bindPopup(popup_bcffd1706bf852de7ef65570a4cd9678)
        ;

        
    
    
            var circle_marker_ef9a240491a6c4af32de008d3c37c372 = L.circleMarker(
                [45.21693, 6.113213333],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_d4d5ae0133b90da663a0d252d64b1780 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_eef7c335a29e3056c871e6b30c2c6895 = $(`<div id=&quot;html_eef7c335a29e3056c871e6b30c2c6895&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: RouteCH<br></div>`)[0];
                popup_d4d5ae0133b90da663a0d252d64b1780.setContent(html_eef7c335a29e3056c871e6b30c2c6895);
            
        

        circle_marker_ef9a240491a6c4af32de008d3c37c372.bindPopup(popup_d4d5ae0133b90da663a0d252d64b1780)
        ;

        
    
    
            var circle_marker_b76b09b4f4c69f638a840b531d7e4236 = L.circleMarker(
                [45.21952167, 6.123273333],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_9163dbada39d393bfc5d18adf06cdcb3 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_275fd4a4599819559f4db8b03aeab2d3 = $(`<div id=&quot;html_275fd4a4599819559f4db8b03aeab2d3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I22<br></div>`)[0];
                popup_9163dbada39d393bfc5d18adf06cdcb3.setContent(html_275fd4a4599819559f4db8b03aeab2d3);
            
        

        circle_marker_b76b09b4f4c69f638a840b531d7e4236.bindPopup(popup_9163dbada39d393bfc5d18adf06cdcb3)
        ;

        
    
    
            var circle_marker_dae891c08c67a9d50e83dcfa9e2cc450 = L.circleMarker(
                [45.21833833, 6.122666667],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_67ac9b44678811fb6ff04b179a21cb85 = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_d57bba3b3738b3bcf136231d52f92017 = $(`<div id=&quot;html_d57bba3b3738b3bcf136231d52f92017&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I13<br></div>`)[0];
                popup_67ac9b44678811fb6ff04b179a21cb85.setContent(html_d57bba3b3738b3bcf136231d52f92017);
            
        

        circle_marker_dae891c08c67a9d50e83dcfa9e2cc450.bindPopup(popup_67ac9b44678811fb6ff04b179a21cb85)
        ;

        
    
    
            var circle_marker_054f24d5bdcbb8fe944591eda71110f8 = L.circleMarker(
                [45.21793167, 6.123648333],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;blue&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;blue&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_49fa0e1b0e9ef50a416626b3010205de = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_52762a41a41cd7129423a21b23f61de6 = $(`<div id=&quot;html_52762a41a41cd7129423a21b23f61de6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I23<br></div>`)[0];
                popup_49fa0e1b0e9ef50a416626b3010205de.setContent(html_52762a41a41cd7129423a21b23f61de6);
            
        

        circle_marker_054f24d5bdcbb8fe944591eda71110f8.bindPopup(popup_49fa0e1b0e9ef50a416626b3010205de)
        ;

        
    
    
            var circle_marker_98cec511033837bf16c347de73c9c626 = L.circleMarker(
                [45.217705, 6.123641667],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;green&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: true, &quot;fillColor&quot;: &quot;green&quot;, &quot;fillOpacity&quot;: 0.8, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;opacity&quot;: 1.0, &quot;radius&quot;: 6, &quot;stroke&quot;: true, &quot;weight&quot;: 3}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);
        
    
        var popup_1409864a2368e0926a3b19a01fa3760a = L.popup({
  &quot;maxWidth&quot;: &quot;100%&quot;,
});

        
            
                var html_111b5320346842717e1b8da5bba211a5 = $(`<div id=&quot;html_111b5320346842717e1b8da5bba211a5&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;>Enregistreur: I15<br></div>`)[0];
                popup_1409864a2368e0926a3b19a01fa3760a.setContent(html_111b5320346842717e1b8da5bba211a5);
            
        

        circle_marker_98cec511033837bf16c347de73c9c626.bindPopup(popup_1409864a2368e0926a3b19a01fa3760a)
        ;

        
    
    
            var layer_control_a4af9a3dce0e2b06ede3e6288ab8ed2d_layers = {
                base_layers : {
                    &quot;openstreetmap&quot; : tile_layer_f21c899512e9b74a022e0695a3662ab3,
                    &quot;Satellite&quot; : tile_layer_fc4db0bb07ed91a9a4845de2a286600a,
                },
                overlays :  {
                },
            };
            let layer_control_a4af9a3dce0e2b06ede3e6288ab8ed2d = L.control.layers(
                layer_control_a4af9a3dce0e2b06ede3e6288ab8ed2d_layers.base_layers,
                layer_control_a4af9a3dce0e2b06ede3e6288ab8ed2d_layers.overlays,
                {
  &quot;position&quot;: &quot;topright&quot;,
  &quot;collapsed&quot;: true,
  &quot;autoZIndex&quot;: true,
}
            ).addTo(map_3b24de28d0fd7fa0a17a4d71537f2f0c);

        
</script>
</html>" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""></iframe></div></div>
</div>
</div>
<p>Figure 1 : Carte des enregistreurs acoustiques posés en 2025</p>
</div>
<p>Les enregistreurs ont été posés mi-juin 2025 avant l’arrivée du troupeau de brebis de l’âne. Deux maintenances ont été effectuées durant l’été et la récupération s’est faite début-octobre. Sur la figure 2, le début et la fin d’enregistrement de chaque audiomoth.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">---
config:
  logLevel: 'debug'
  theme: 'neutral'
---
timeline
    title Timeline des maintenances terrain
    16 juin : Pose
    21 juillet : Maintenance 1
    19 août : Maintenance 2
    2 octobre : Récupération
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div id="timeline">
<div id="42871b8a" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="660" src="iframe_figures/figure_4.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Figure 2 : Début et fin d’enregistrement de chaque Logger”</p>
</div>
<p>La figure 3 nous montre les précipitations et la température relevés par la station météo de l’âne. Une courbe fine toutes les 10 minutes est disponible ainsi qu’une autre avec une variation journalière.</p>
<div id="meteo">
<div id="5ce50e8a" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="520" src="iframe_figures/figure_5.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Figure 3: Précipitation et température relevé par la station metéo de Belledonne</p>
</div>
</section>
<section id="spectrogramme-long-terme" class="level2">
<h2 class="anchored" data-anchor-id="spectrogramme-long-terme">Spectrogramme long terme</h2>
<p>La figure 4 permet de voir les spectrogramme long terme de chaque enregistreurs. un menu déroulant permet de choisir l’enregistreur désiré. Une photo de la map avec le nom de tous les enregistreurs est en fin de page figure 7.</p>
<div id="LTSA">
<div id="927490bb" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="385" src="iframe_figures/figure_6.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Figure 4 : Spectrogramme long terme de chaque logger</p>
</div>
</section>
<section id="leq" class="level2">
<h2 class="anchored" data-anchor-id="leq">Leq</h2>
<p>La figure 5 montre l’évolution du Leq (entre 8 et 42 kHz) - un menu déroulant permet de choisir parmis 3 périodes. La figure est mise en relation avec la météo. un zoom sur le Leq permet également le meme zoom sur la météo. Le choix des courbes visibles est dynamique; il suffit de cliquer deux fois sur un enregistreur pour n’afficher que sa courbe et passer tous les autres en invisible. On peut additionner ensuite autant de courbe qu’on le veut en cliquant sur les courbes que l’on souhaite ajouter.</p>
<div id="Leq">
<div id="74484a67" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="100%" height="820" src="iframe_figures/figure_7.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Figure 5 : LEq disponible pour 3 périodes avec choix dynamique de ou des enregistreurs souhaités – Fenêtres temporelles &amp; météo synchronisées</p>
</div>
<p>Une autre visualisation en heatmap est disponible sur la figure 6. Avec coloration en mauve pour insecte et en vert pour la pluie (pour le moment les données proviennent de la station météo)</p>
<div id="0042287a" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="720px" height="370" src="iframe_figures/figure_8.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<div id="heatmap2">
<div id="f314ca83" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="720px" height="370" src="iframe_figures/figure_9.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>Figure 6 : Heatmap avec bruit insecte en mauve et bruit de la pluie en vert</p>
</div>
<div id="photo-map">
<div id="1497e230" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-9-output-1.png" width="763" height="456" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Figure 7 : Photo de la map avec les noms des enregistreurs</p>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Enregistrements acoustiques 2025 dans la RNCFS de Belledonne</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Margaux Thieury</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> '2025-11-24'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> short</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">  enabled: true</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## La pose des enregistreurs audiomoth et la météo sur Belledonne</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>Durant l'été 2025, 32 enregistreurs de type audiomoth ont été posé dans la RNCFS de Belledonne. Leur emplacement est visble sur la carte ci-dessous Figure 1. </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>(point cliquable pour connaitre le nom de l'enregistreur)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>::: {#map}</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger le fichier Excel</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">"data/Carte/points.xlsx"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Correction des virgules pour les coordonnées</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'coord_X'</span>] <span class="op">=</span> df[<span class="st">'coord_X'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">'.'</span>).astype(<span class="bu">float</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'coord_Y'</span>] <span class="op">=</span> df[<span class="st">'coord_Y'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">'.'</span>).astype(<span class="bu">float</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir des couleurs selon l'habitat</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>color_dict <span class="op">=</span> {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PS'</span>: <span class="st">'green'</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LF'</span>: <span class="st">'blue'</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ajoute d'autres habitats si nécessaire</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer la carte centrée sur la moyenne des coordonnées</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[df[<span class="st">'coord_Y'</span>].mean(), df[<span class="st">'coord_X'</span>].mean()], zoom_start<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter le fonds satellite</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>folium.TileLayer(</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    tiles<span class="op">=</span><span class="st">'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/</span><span class="sc">{z}</span><span class="st">/</span><span class="sc">{y}</span><span class="st">/</span><span class="sc">{x}</span><span class="st">'</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    attr<span class="op">=</span><span class="st">'Esri World Imagery'</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Satellite'</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>).add_to(m)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter les points colorés avec popup affichant le nom de l'enregistreur</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> color_dict.get(row[<span class="st">'Habitat'</span>], <span class="st">'gray'</span>)  <span class="co"># couleur par défaut si habitat inconnu</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    folium.CircleMarker(</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>[row[<span class="st">'coord_Y'</span>], row[<span class="st">'coord_X'</span>]],</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        radius<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>color,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        fill_color<span class="op">=</span>color,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        fill_opacity<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>(</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Enregistreur: </span><span class="sc">{</span>row[<span class="st">'nom_enregistreur'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;"</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    ).add_to(m)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>legend_html <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div style="</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">    position: fixed; </span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="st">    bottom: 50px; left: 50px; width: 150px; height: 90px; </span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="st">    z-index:9999; font-size:14px; color:white;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="st">    "&gt;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;b&gt;Légende&lt;/b&gt;&lt;br&gt;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;i class="fa fa-circle" style="color:green"&gt;&lt;/i&gt; Pelouse sèche&lt;br&gt;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;i class="fa fa-circle" style="color:blue"&gt;&lt;/i&gt; Lande fraîche&lt;br&gt;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>m.get_root().html.add_child(folium.Element(legend_html))</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrôle des couches si besoin</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>folium.LayerControl().add_to(m)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la carte</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>m</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>Figure 1 : Carte des enregistreurs acoustiques posés en 2025</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>Les enregistreurs ont été posés mi-juin 2025 avant l'arrivée du troupeau de brebis de l'âne. Deux maintenances ont été effectuées durant l'été et la récupération s'est faite début-octobre. Sur la figure 2, le début et la fin d'enregistrement de chaque audiomoth. </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>config:</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  logLevel: <span class="ot">'</span><span class="ss">debug</span><span class="ot">'</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  theme: <span class="ot">'</span><span class="ss">neutral</span><span class="ot">'</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>timeline</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    title Timeline des maintenances terrain</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="dv">16</span> juin : Pose</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="dv">21</span> juillet : Maintenance <span class="dv">1</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="dv">19</span> août : Maintenance <span class="dv">2</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> octobre : Récupération</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>::: {#timeline}</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Répertoire LTSA</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>BASE_PATH <span class="op">=</span> <span class="vs">r"data</span><span class="er">\</span><span class="vs">LTSA"</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Trouver tous les enregistreurs (sous-dossiers)</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>loggers <span class="op">=</span> <span class="bu">sorted</span>([d <span class="cf">for</span> d <span class="kw">in</span> os.listdir(BASE_PATH) <span class="cf">if</span> os.path.isdir(os.path.join(BASE_PATH, d))])</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> []</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> logger <span class="kw">in</span> loggers:</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    folder <span class="op">=</span> os.path.join(BASE_PATH, logger)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    ts_file <span class="op">=</span> os.path.join(folder, <span class="st">"noms_fichiers.pkl"</span>)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(ts_file):</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"⚠ Pas de noms_fichiers.pkl pour </span><span class="sc">{</span>logger<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Charger les timestamps</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(ts_file, <span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>        tlist <span class="op">=</span> pickle.load(f)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convertir en datetime si nécessaire</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    timestamps <span class="op">=</span> pd.to_datetime(tlist)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> timestamps.<span class="bu">min</span>()</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> timestamps.<span class="bu">max</span>()</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    records.append({</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Logger"</span>: logger,</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Start"</span>: start,</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>        <span class="st">"End"</span>: end</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame pour Plotly</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>df_gantt <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: timeline </span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Début et fin d'enregistrement de chaque Logger"</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Créer le graphique ---</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.timeline(</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>    df_gantt,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    x_start<span class="op">=</span><span class="st">"Start"</span>,</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    x_end<span class="op">=</span><span class="st">"End"</span>,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Logger"</span>,</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Logger"</span>,</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title="Début et fin d'enregistrement de chaque Logger"</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(autorange<span class="op">=</span><span class="st">"reversed"</span>)  <span class="co"># Premier en haut</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    plot_bgcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    paper_bgcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span> <span class="bu">len</span>(df_gantt)<span class="op">*</span><span class="dv">20</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>Figure 2 : Début et fin d'enregistrement de chaque Logger"</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>La figure 3 nous montre les précipitations et la température relevés par la station météo de l'âne. Une courbe fine toutes les 10 minutes est disponible ainsi qu'une autre avec une variation journalière.</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>::: {#meteo}</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Charger les données ---</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">"data/meteo/Rncfs_Belledonne_Meteo_2025_simplifie.xlsx"</span>)</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'TIMESTAMP'</span>], dayfirst<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'timestamp'</span>] <span class="op">=</span> df[<span class="st">'timestamp'</span>].dt.tz_localize(<span class="st">'UTC'</span>).dt.tz_convert(<span class="st">'Europe/Paris'</span>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrer la période souhaitée</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"2025-06-15"</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2025-10-02"</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df[<span class="st">'timestamp'</span>] <span class="op">&gt;=</span> start_date) <span class="op">&amp;</span> (df[<span class="st">'timestamp'</span>] <span class="op">&lt;=</span> end_date)]</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Préparer les deux versions ---</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>df_fine <span class="op">=</span> df.copy()</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Average par jour</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'date'</span>] <span class="op">=</span> df[<span class="st">'timestamp'</span>].dt.date</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>mask_temp <span class="op">=</span> (df[<span class="st">'timestamp'</span>].dt.hour <span class="op">&gt;=</span> <span class="dv">10</span>) <span class="op">&amp;</span> (df[<span class="st">'timestamp'</span>].dt.hour <span class="op">&lt;=</span> <span class="dv">16</span>)</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>df_temp <span class="op">=</span> df.loc[mask_temp].groupby(<span class="st">'date'</span>)[<span class="st">'Temperature'</span>].mean().reset_index()</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>mask_precip <span class="op">=</span> (df[<span class="st">'timestamp'</span>].dt.hour <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (df[<span class="st">'timestamp'</span>].dt.hour <span class="op">&lt;=</span> <span class="dv">23</span>)</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>df_precip <span class="op">=</span> df.loc[mask_precip].groupby(<span class="st">'date'</span>)[<span class="st">'précipitation'</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Créer la figure avec dropdown ---</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace Fine</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_fine[<span class="st">'timestamp'</span>],</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_fine[<span class="st">'Temperature'</span>],</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mode='lines+markers',</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Température (Fine)'</span>,</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>),</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'%</span><span class="sc">{x}</span><span class="st">: %</span><span class="sc">{y:.1f}</span><span class="st"> °C'</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Bar(</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_fine[<span class="st">'timestamp'</span>],</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_fine[<span class="st">'précipitation'</span>],</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Précipitation (Fine)'</span>,</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    marker_color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'%</span><span class="sc">{x}</span><span class="st">: %</span><span class="sc">{y:.1f}</span><span class="st"> mm'</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace Average</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_temp[<span class="st">'date'</span>],</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_temp[<span class="st">'Temperature'</span>],</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mode='lines+markers',</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Température (Average)'</span>,</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>),</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y1'</span>,</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'%</span><span class="sc">{x}</span><span class="st">: %</span><span class="sc">{y:.1f}</span><span class="st"> °C'</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Bar(</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_precip[<span class="st">'date'</span>],</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_precip[<span class="st">'précipitation'</span>],</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Précipitation (Average)'</span>,</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>    marker_color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y2'</span>,</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span><span class="st">'%</span><span class="sc">{x}</span><span class="st">: %</span><span class="sc">{y:.1f}</span><span class="st"> mm'</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Dropdown ---</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>[<span class="bu">dict</span>(</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>        active<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>        buttons<span class="op">=</span>[</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(label<span class="op">=</span><span class="st">"Données 10min"</span>,</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>                 method<span class="op">=</span><span class="st">"update"</span>,</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>                 args<span class="op">=</span>[{<span class="st">"visible"</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]},</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>                       {<span class="st">"title"</span>: <span class="st">"Données fines"</span>}]),</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(label<span class="op">=</span><span class="st">"Données journalières"</span>,</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>                 method<span class="op">=</span><span class="st">"update"</span>,</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>                 args<span class="op">=</span>[{<span class="st">"visible"</span>: [<span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">True</span>]},</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>                       {<span class="st">"title"</span>: <span class="st">"Données quotidiennes (Average)"</span>}])</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="fl">1.15</span>, xanchor<span class="op">=</span><span class="st">'left'</span>, yanchor<span class="op">=</span><span class="st">'top'</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>    )],</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title="Température et Précipitation",</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Date"</span>),</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Température (°C)"</span>, side<span class="op">=</span><span class="st">'left'</span>, showgrid<span class="op">=</span><span class="va">True</span>, zeroline<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>    yaxis2<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Précipitation (mm)"</span>, overlaying<span class="op">=</span><span class="st">'y'</span>, side<span class="op">=</span><span class="st">'right'</span>, showgrid<span class="op">=</span><span class="va">False</span>, zeroline<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    plot_bgcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    paper_bgcolor<span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>    shapes<span class="op">=</span>[<span class="bu">dict</span>(<span class="bu">type</span><span class="op">=</span><span class="st">'rect'</span>, xref<span class="op">=</span><span class="st">'paper'</span>, yref<span class="op">=</span><span class="st">'paper'</span>,</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>                 x0<span class="op">=</span><span class="dv">0</span>, y0<span class="op">=</span><span class="dv">0</span>, x1<span class="op">=</span><span class="dv">1</span>, y1<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>                 line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>                 fillcolor<span class="op">=</span><span class="st">'rgba(0,0,0,0)'</span>, layer<span class="op">=</span><span class="st">'above'</span>)]</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>Figure 3: Précipitation et température relevé par la station metéo de Belledonne</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spectrogramme long terme</span></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>La figure 4 permet de voir les spectrogramme long terme de chaque enregistreurs. un menu déroulant permet de choisir l'enregistreur désiré.</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>Une photo de la map avec le nom de tous les enregistreurs est en fin de page figure 7.</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>::: {#LTSA}</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a><span class="co"># --- CONFIG ---</span></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>BASE_PATH <span class="op">=</span> <span class="vs">r"data/LTSA/"</span></span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>eps <span class="op">=</span> <span class="fl">1e-12</span></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>font_size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>n_ticks <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a><span class="co"># Facteur de downsampling</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>time_step <span class="op">=</span> <span class="dv">6</span>   <span class="co"># 1 point sur 5 en temps</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>freq_step <span class="op">=</span> <span class="dv">4</span>   <span class="co"># 1 fréquence sur 2</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Lister les dossiers disponibles ---</span></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>loggers <span class="op">=</span> <span class="bu">sorted</span>([d <span class="cf">for</span> d <span class="kw">in</span> os.listdir(BASE_PATH)</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">if</span> os.path.isdir(os.path.join(BASE_PATH, d))])</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Enregistreurs trouvés :", loggers)</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Charger tous les LTSA ---</span></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>LTSA <span class="op">=</span> {}</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> logger <span class="kw">in</span> loggers:</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>    folder <span class="op">=</span> os.path.join(BASE_PATH, logger)</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>    psd_file <span class="op">=</span> os.path.join(folder, <span class="st">"psd_array.npy"</span>)</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>    freq_file <span class="op">=</span> os.path.join(folder, <span class="st">"frequencies.npy"</span>)</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>    ts_file <span class="op">=</span> os.path.join(folder, <span class="st">"noms_fichiers.pkl"</span>)</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(psd_file):</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"⚠ Pas de psd_array.npy pour"</span>, logger)</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>    psd <span class="op">=</span> np.load(psd_file)</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>    freqs <span class="op">=</span> np.load(freq_file)</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(ts_file, <span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>        tlist <span class="op">=</span> pickle.load(f)</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>    timestamps <span class="op">=</span> pd.to_datetime(tlist)</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- Downsampling ---</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>    psd_ds <span class="op">=</span> psd[::time_step, ::freq_step]           <span class="co"># attention : psd shape = (nt, nf)</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>    freqs_ds <span class="op">=</span> freqs[::freq_step]</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>    timestamps_ds <span class="op">=</span> timestamps[::time_step]</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>    LTSA[logger] <span class="op">=</span> {</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>        <span class="st">"psd"</span>: psd_ds,</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>        <span class="st">"freqs"</span>: freqs_ds,</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>        <span class="st">"timestamps"</span>: timestamps_ds</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Préparer la figure initiale ---</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>first <span class="op">=</span> <span class="bu">list</span>(LTSA.keys())[<span class="dv">0</span>]</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>psd0 <span class="op">=</span> LTSA[first][<span class="st">"psd"</span>]</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>freqs0 <span class="op">=</span> LTSA[first][<span class="st">"freqs"</span>]</span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>timestamps0 <span class="op">=</span> LTSA[first][<span class="st">"timestamps"</span>]</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>Z0 <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> np.log10(psd0.T <span class="op">+</span> eps)</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>go.Heatmap(</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>        z<span class="op">=</span>Z0,</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>timestamps0,</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>freqs0,</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">"Jet"</span>,</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>        showscale<span class="op">=</span><span class="va">False</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Créer les boutons dropdown ---</span></span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>buttons <span class="op">=</span> []</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> logger <span class="kw">in</span> LTSA.keys():</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>    psd <span class="op">=</span> LTSA[logger][<span class="st">"psd"</span>]</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>    freqs <span class="op">=</span> LTSA[logger][<span class="st">"freqs"</span>]</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>    timestamps <span class="op">=</span> LTSA[logger][<span class="st">"timestamps"</span>]</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> np.log10(psd.T <span class="op">+</span> eps)</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ticks X</span></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>    tick_positions <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="bu">len</span>(timestamps)<span class="op">-</span><span class="dv">1</span>, n_ticks).astype(<span class="bu">int</span>)</span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>    tick_vals <span class="op">=</span> timestamps[tick_positions]</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>    tick_texts <span class="op">=</span> [t.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>) <span class="cf">for</span> t <span class="kw">in</span> tick_vals]</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>    buttons.append(</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>        <span class="bu">dict</span>(</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>logger,</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>            method<span class="op">=</span><span class="st">"update"</span>,</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>            args<span class="op">=</span>[</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>                {<span class="st">"z"</span>: [Z], <span class="st">"x"</span>: [timestamps], <span class="st">"y"</span>: [freqs]},</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#"title": f"LTSA – {logger}",</span></span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis"</span>: <span class="bu">dict</span>(</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>                        tickmode<span class="op">=</span><span class="st">"array"</span>,</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>                        tickvals<span class="op">=</span>tick_vals,</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>                        ticktext<span class="op">=</span>tick_texts,</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>                        tickangle<span class="op">=</span><span class="dv">45</span>,</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>                        tickfont<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size),</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>                        title_font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size<span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"yaxis"</span>: <span class="bu">dict</span>(</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>                        tickfont<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size),</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>                        title_font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size<span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Layout ---</span></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title=f"LTSA – {first}",</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>    title_font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size<span class="op">+</span><span class="dv">15</span>),</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span>font_size),</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">365</span>,</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>    autosize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>[<span class="bu">dict</span>(</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>        buttons<span class="op">=</span>buttons,</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>        direction<span class="op">=</span><span class="st">"down"</span>,</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>        showactive<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="fl">1.2</span></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    )]</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>Figure 4 : Spectrogramme long terme de chaque logger</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a><span class="fu">## Leq</span></span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>La figure 5 montre l'évolution du Leq (entre 8 et 42 kHz) - un menu déroulant permet de choisir parmis 3 périodes. La figure est mise en relation avec la météo. un zoom sur le Leq permet également le meme zoom sur la météo.</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>Le choix des courbes visibles est dynamique; il suffit de cliquer deux fois sur un enregistreur pour n'afficher que sa courbe et passer tous les autres en invisible. On peut additionner ensuite autant de courbe qu'on le veut en cliquant sur les courbes que l'on souhaite ajouter.</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>::: {#Leq}</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> maad <span class="im">import</span> util</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> time</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) PARAMÈTRES – plages horaires</span></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>start_time_day     <span class="op">=</span> time(<span class="dv">7</span>, <span class="dv">0</span>)</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>end_time_day       <span class="op">=</span> time(<span class="dv">18</span>, <span class="dv">0</span>)</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>start_time_morning <span class="op">=</span> time(<span class="dv">7</span>, <span class="dv">0</span>)</span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>end_time_morning   <span class="op">=</span> time(<span class="dv">12</span>, <span class="dv">0</span>)</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>start_time_night   <span class="op">=</span> time(<span class="dv">21</span>, <span class="dv">0</span>)</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>end_time_night     <span class="op">=</span> time(<span class="dv">23</span>, <span class="dv">59</span>)</span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) HABITATS – depuis le fichier Excel</span></span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>df_points <span class="op">=</span> pd.read_excel(<span class="st">"data/Carte/points.xlsx"</span>)</span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>habitats <span class="op">=</span> pd.Series(df_points.Habitat.values, index<span class="op">=</span>df_points.nom_enregistreur).to_dict()</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) LECTURE DES DONNÉES LEQ (bande insecte2)</span></span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a>base_path <span class="op">=</span> <span class="vs">r"data</span><span class="dv">\S</span><span class="vs">PL"</span></span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a>band <span class="op">=</span> <span class="bu">slice</span>(<span class="dv">8</span>, <span class="dv">22</span>)   <span class="co"># insecte2</span></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>folders <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(base_path) <span class="cf">if</span> os.path.isdir(os.path.join(base_path, f))]</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>leq_daily, leq_morning, leq_night <span class="op">=</span> {}, {}, {}</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> folder <span class="kw">in</span> folders:</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>    df_path <span class="op">=</span> os.path.join(base_path, folder, <span class="st">"db_spl.pkl"</span>)</span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(df_path):</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(df_path, <span class="st">"rb"</span>) <span class="im">as</span> f:</span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>        df_spl <span class="op">=</span> pickle.load(f)</span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_spl.iloc[:, band]</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> data.<span class="bu">apply</span>(util.add_dB, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>    leq_daily[folder]   <span class="op">=</span> data.between_time(start_time_day,     end_time_day)     .resample(<span class="st">"D"</span>).<span class="bu">apply</span>(util.mean_dB)</span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>    leq_morning[folder] <span class="op">=</span> data.between_time(start_time_morning, end_time_morning) .resample(<span class="st">"D"</span>).<span class="bu">apply</span>(util.mean_dB)</span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a>    leq_night[folder]   <span class="op">=</span> data.between_time(start_time_night,   end_time_night)   .resample(<span class="st">"D"</span>).<span class="bu">apply</span>(util.mean_dB)</span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>df_daily   <span class="op">=</span> pd.DataFrame(leq_daily).loc[<span class="st">"2025-06-15"</span>:<span class="st">"2025-10-02"</span>]</span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>df_morning <span class="op">=</span> pd.DataFrame(leq_morning).loc[<span class="st">"2025-06-15"</span>:<span class="st">"2025-10-02"</span>]</span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>df_night   <span class="op">=</span> pd.DataFrame(leq_night).loc[<span class="st">"2025-06-15"</span>:<span class="st">"2025-10-02"</span>]</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>rec_list <span class="op">=</span> <span class="bu">list</span>(df_daily.columns)</span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>n_rec <span class="op">=</span> <span class="bu">len</span>(rec_list)</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) CALCUL DES OFFSETS – aligner toutes les courbes sur minima nuit</span></span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>min_night <span class="op">=</span> df_night.<span class="bu">min</span>()</span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>mean_min  <span class="op">=</span> min_night.mean()</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>offsets   <span class="op">=</span> mean_min <span class="op">-</span> min_night</span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>df_daily_aligned   <span class="op">=</span> df_daily <span class="op">+</span> offsets</span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>df_morning_aligned <span class="op">=</span> df_morning <span class="op">+</span> offsets</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>df_night_aligned   <span class="op">=</span> df_night <span class="op">+</span> offsets</span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) LECTURE DES DONNÉES MÉTÉO</span></span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>meteo_path <span class="op">=</span> <span class="vs">r"data/meteo/Rncfs_Belledonne_Meteo_2025_simplifie</span><span class="dv">.</span><span class="vs">xlsx"</span></span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a>df_meteo <span class="op">=</span> pd.read_excel(meteo_path)</span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>df_meteo[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(df_meteo[<span class="st">'TIMESTAMP'</span>], dayfirst<span class="op">=</span><span class="va">True</span>).dt.tz_localize(<span class="st">'UTC'</span>).dt.tz_convert(<span class="st">'Europe/Paris'</span>)</span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a>df_meteo <span class="op">=</span> df_meteo[(df_meteo[<span class="st">'timestamp'</span>] <span class="op">&gt;=</span> <span class="st">"2025-06-15"</span>) <span class="op">&amp;</span> (df_meteo[<span class="st">'timestamp'</span>] <span class="op">&lt;=</span> <span class="st">"2025-10-02"</span>)]</span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a>df_meteo[<span class="st">"date"</span>] <span class="op">=</span> df_meteo[<span class="st">"timestamp"</span>].dt.date</span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a>df_temp   <span class="op">=</span> df_meteo.groupby(<span class="st">"date"</span>)[<span class="st">"Temperature"</span>].mean().reset_index()</span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a>df_precip <span class="op">=</span> df_meteo.groupby(<span class="st">"date"</span>)[<span class="st">"précipitation"</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) FIGURE – subplots avec météo synchronisée</span></span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> make_subplots(</span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>    rows<span class="op">=</span><span class="dv">2</span>, cols<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>    shared_xaxes<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>    vertical_spacing<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>    specs<span class="op">=</span>[[{}],[{<span class="st">"secondary_y"</span>: <span class="va">True</span>}]]</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subplot_titles=("LEq insecte2", "Météo")</span></span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a><span class="co"># --- LEQ subplot</span></span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, rec <span class="kw">in</span> <span class="bu">enumerate</span>(rec_list):</span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>    habitat <span class="op">=</span> habitats.get(rec, <span class="st">"Inconnu"</span>)</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(</span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df_daily_aligned.index,</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df_daily_aligned[rec],</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>rec<span class="sc">}</span><span class="ss"> – </span><span class="sc">{</span>habitat<span class="sc">}</span><span class="ss"> – journée"</span>,</span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span><span class="va">True</span>  <span class="co"># seulement le premier visible au départ</span></span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>    ), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(</span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df_morning_aligned.index,</span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df_morning_aligned[rec],</span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>rec<span class="sc">}</span><span class="ss"> – </span><span class="sc">{</span>habitat<span class="sc">}</span><span class="ss"> – matin"</span>,</span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span><span class="va">False</span></span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>    ), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(</span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df_night_aligned.index,</span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df_night_aligned[rec],</span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">"lines"</span>,</span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>rec<span class="sc">}</span><span class="ss"> – </span><span class="sc">{</span>habitat<span class="sc">}</span><span class="ss"> – soir"</span>,</span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span><span class="va">False</span></span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>    ), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Météo subplot</span></span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_temp[<span class="st">'date'</span>],</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_temp[<span class="st">'Temperature'</span>],</span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>),</span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Température (°C)'</span>,</span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span> </span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>, secondary_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Bar(</span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_precip[<span class="st">'date'</span>],</span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_precip[<span class="st">'précipitation'</span>],</span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Précipitation (mm)'</span>,</span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>    marker_color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a>    visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span> </span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>, secondary_y<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) MENU DÉROULANT – choisir la fenêtre temporelle</span></span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>buttons <span class="op">=</span> []</span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a><span class="co"># Journée</span></span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>vis_day <span class="op">=</span> [<span class="va">True</span>] <span class="op">+</span> [<span class="va">False</span>]<span class="op">*</span>(<span class="dv">3</span><span class="op">*</span>n_rec<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>vis_day <span class="op">+=</span> [<span class="va">True</span>, <span class="va">True</span>]  <span class="co"># météo toujours visible</span></span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>buttons.append(<span class="bu">dict</span>(label<span class="op">=</span><span class="st">"Journée (7h–18h)"</span>, method<span class="op">=</span><span class="st">"update"</span>, args<span class="op">=</span>[{<span class="st">"visible"</span>: vis_day}, {<span class="st">"title"</span>: <span class="st">"LEq insecte2 – Journée"</span>}]))</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Matin</span></span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a>vis_morning <span class="op">=</span> []</span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_rec):</span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a>    vis_morning <span class="op">+=</span> [<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>]  <span class="co"># quotidien, matin, nuit</span></span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>vis_morning <span class="op">+=</span> [<span class="va">True</span>, <span class="va">True</span>]  <span class="co"># météo</span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>buttons.append(<span class="bu">dict</span>(label<span class="op">=</span><span class="st">"Matin (7h–12h)"</span>, method<span class="op">=</span><span class="st">"update"</span>, args<span class="op">=</span>[{<span class="st">"visible"</span>:vis_morning}, {<span class="st">"title"</span>:<span class="st">"LEq insecte2 – Matin"</span>}]))</span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Soir</span></span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>vis_night <span class="op">=</span> []</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_rec):</span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a>    vis_night <span class="op">+=</span> [<span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>]  <span class="co"># quotidien, matin, nuit</span></span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a>vis_night <span class="op">+=</span> [<span class="va">True</span>, <span class="va">True</span>]  <span class="co"># météo</span></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>buttons.append(<span class="bu">dict</span>(label<span class="op">=</span><span class="st">"Soir (21h–24h)"</span>, method<span class="op">=</span><span class="st">"update"</span>, args<span class="op">=</span>[{<span class="st">"visible"</span>:vis_night}, {<span class="st">"title"</span>:<span class="st">"LEq insecte2 – Soir"</span>}]))</span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>[<span class="bu">dict</span>(buttons<span class="op">=</span>buttons, x<span class="op">=</span><span class="dv">0</span>, y<span class="op">=</span><span class="fl">1.15</span>, xanchor<span class="op">=</span><span class="st">"left"</span>, yanchor<span class="op">=</span><span class="st">"top"</span>)],</span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">800</span>,</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a>    plot_bgcolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a>    paper_bgcolor<span class="op">=</span><span class="st">"white"</span></span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a><span class="co"># Axes météo</span></span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title_text<span class="op">=</span><span class="st">"LEq (dB)"</span>, row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(showgrid<span class="op">=</span><span class="va">True</span>, gridwidth<span class="op">=</span><span class="dv">1</span>, gridcolor<span class="op">=</span><span class="st">'lightgray'</span>, row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title_text<span class="op">=</span><span class="st">"Précipitation (mm)"</span>, row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>, secondary_y<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title_text<span class="op">=</span><span class="st">"Température (°C)"</span>, row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>, secondary_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title_text<span class="op">=</span><span class="st">"Date"</span>, row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>Figure 5 : LEq disponible pour 3 périodes avec choix dynamique de ou des enregistreurs souhaités – Fenêtres temporelles &amp; météo synchronisées</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a>Une autre visualisation en heatmap est disponible sur la figure 6. Avec coloration en mauve pour insecte et en vert pour la pluie (pour le moment les données proviennent de la station météo)</span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ephem</span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytz</span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>local_tz <span class="op">=</span> pytz.timezone(<span class="st">"Europe/Paris"</span>)</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Paramètres ----</span></span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a>base_folder_spl <span class="op">=</span> <span class="st">"data/SPL"</span></span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>meteo_path <span class="op">=</span> <span class="vs">r"data/meteo/Rncfs_Belledonne_Meteo_2025_simplifie</span><span class="dv">.</span><span class="vs">xlsx"</span></span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">45.109984180407984</span></span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a>longitude <span class="op">=</span> <span class="fl">6.11257375591396</span></span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Fonction lever/coucher soleil ----</span></span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heures_lever_coucher_soleil(latitude, longitude, date):</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a>    lieu <span class="op">=</span> ephem.Observer()</span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>    lieu.lat <span class="op">=</span> <span class="bu">str</span>(latitude)</span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>    lieu.lon <span class="op">=</span> <span class="bu">str</span>(longitude)</span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a>    lieu.date <span class="op">=</span> date</span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>    lever_soleil <span class="op">=</span> lieu.next_rising(ephem.Sun()).datetime()</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a>    coucher_soleil <span class="op">=</span> lieu.next_setting(ephem.Sun()).datetime()</span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>    lever_soleil <span class="op">=</span> lever_soleil.replace(tzinfo<span class="op">=</span>pytz.utc).astimezone(local_tz)</span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a>    coucher_soleil <span class="op">=</span> coucher_soleil.replace(tzinfo<span class="op">=</span>pytz.utc).astimezone(local_tz)</span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lever_soleil, coucher_soleil</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Lister les enregistreurs dynamiquement ----</span></span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a>enregistreurs <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(base_folder_spl) <span class="cf">if</span> os.path.isdir(os.path.join(base_folder_spl, f))]</span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>enregistreurs.sort()  <span class="co"># Tri alphabétique</span></span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Charger météo ----</span></span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>df_p <span class="op">=</span> pd.read_excel(meteo_path)</span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(df_p[<span class="st">'TIMESTAMP'</span>], utc<span class="op">=</span><span class="va">True</span>)  <span class="co"># UTC</span></span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'timestamp'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.tz_convert(<span class="st">'Europe/Paris'</span>)  <span class="co"># Conversion en heure locale</span></span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'time'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.time</span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'date'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.date</span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a>df_p <span class="op">=</span> df_p[df_p[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> t: t.minute <span class="kw">in</span> [<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">40</span>])]  <span class="co"># 15 min step</span></span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'time_str'</span>] <span class="op">=</span> df_p[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.strftime(<span class="st">'%H:%M'</span>))</span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'Rain'</span>] <span class="op">=</span> pd.to_numeric(df_p[<span class="st">'précipitation'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'Rain_binary'</span>] <span class="op">=</span> df_p[<span class="st">'Rain'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Préparer les heatmaps pour chaque enregistreur ----</span></span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a>heatmaps <span class="op">=</span> {}</span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> enreg <span class="kw">in</span> enregistreurs:</span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>    folder_spl <span class="op">=</span> os.path.join(base_folder_spl, enreg)</span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a>    spl_file <span class="op">=</span> os.path.join(folder_spl, <span class="st">'db_spl.pkl'</span>)</span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(spl_file):</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(spl_file, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a>        df_spl <span class="op">=</span> pickle.load(f)</span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'date'</span>] <span class="op">=</span> df_spl.index.date</span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'time'</span>] <span class="op">=</span> df_spl.index.time</span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'time_str'</span>] <span class="op">=</span> df_spl[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.strftime(<span class="st">'%H:%M'</span>))</span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>    selected_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df_spl.columns <span class="cf">if</span> <span class="bu">any</span>(<span class="bu">str</span>(i) <span class="kw">in</span> col <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>,<span class="dv">43</span>))]</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'avg_spl'</span>] <span class="op">=</span> df_spl[selected_columns].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a>    heatmap_data <span class="op">=</span> df_spl.pivot_table(</span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a>        values<span class="op">=</span><span class="st">'avg_spl'</span>,</span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span><span class="st">'time_str'</span>,</span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span><span class="st">'date'</span>,</span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>        aggfunc<span class="op">=</span><span class="st">'mean'</span></span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>    df_met <span class="op">=</span> df_p[df_p[<span class="st">'date'</span>].isin(heatmap_data.columns)]</span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a>    heatmap_rain <span class="op">=</span> df_met.pivot_table(</span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a>        values<span class="op">=</span><span class="st">'Rain_binary'</span>,</span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span><span class="st">'time_str'</span>,</span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span><span class="st">'date'</span>,</span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a>        aggfunc<span class="op">=</span><span class="st">'max'</span>,</span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a>        fill_value<span class="op">=</span><span class="dv">0</span></span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a>    heatmap_rain <span class="op">=</span> heatmap_rain.reindex(index<span class="op">=</span>heatmap_data.index, columns<span class="op">=</span>pd.to_datetime(heatmap_data.columns), fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a>    rain_mask <span class="op">=</span> heatmap_rain <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a>    heatmaps[enreg] <span class="op">=</span> {<span class="st">'spl'</span>: heatmap_data, <span class="st">'rain_mask'</span>: rain_mask}</span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Construire figure Plotly ----</span></span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, enreg <span class="kw">in</span> <span class="bu">enumerate</span>(enregistreurs):</span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> heatmaps.get(enreg)</span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a>    spl <span class="op">=</span> data[<span class="st">'spl'</span>]</span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> data[<span class="st">'rain_mask'</span>]</span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a>    z_spl <span class="op">=</span> spl.values.copy()</span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a>    z_spl[mask.values] <span class="op">=</span> np.nan</span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a>    trace_spl <span class="op">=</span> go.Heatmap(</span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a>        z<span class="op">=</span>z_spl,</span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(spl.columns))),</span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>spl.index,</span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'Purples'</span>,</span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a>        zmin<span class="op">=</span><span class="dv">25</span>, zmax<span class="op">=</span><span class="dv">60</span>,</span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a>        showscale<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span>(i<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a>    z_rain <span class="op">=</span> spl.values.copy()</span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a>    z_rain[<span class="op">~</span>mask.values] <span class="op">=</span> np.nan</span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a>    trace_rain <span class="op">=</span> go.Heatmap(</span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a>        z<span class="op">=</span>z_rain,</span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(spl.columns))),</span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>spl.index,</span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'Greens'</span>,</span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a>        showscale<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span>(i<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace_spl)</span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace_rain)</span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Dropdown ----</span></span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>buttons <span class="op">=</span> []</span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, enreg <span class="kw">in</span> <span class="bu">enumerate</span>(enregistreurs):</span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a>    vis <span class="op">=</span> [<span class="va">False</span>]<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span><span class="bu">len</span>(enregistreurs))</span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a>    vis[<span class="dv">2</span><span class="op">*</span>i] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a>    vis[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a>    buttons.append(<span class="bu">dict</span>(label<span class="op">=</span>enreg,</span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a>                        method<span class="op">=</span><span class="st">'update'</span>,</span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a>                        args<span class="op">=</span>[{<span class="st">'visible'</span>: vis},</span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a>                              {<span class="st">'title'</span>:<span class="ss">f"Heatmap SPL 2025 – </span><span class="sc">{</span>enreg<span class="sc">}</span><span class="ss">"</span>}]))</span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>[<span class="bu">dict</span>(buttons<span class="op">=</span>buttons, x<span class="op">=</span><span class="fl">0.0</span>, y<span class="op">=</span><span class="fl">1.15</span>, xanchor<span class="op">=</span><span class="st">'left'</span>, yanchor<span class="op">=</span><span class="st">'top'</span>)],</span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title=f"Heatmap SPL 2025 – {enregistreurs[0]}",</span></span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Date"</span>,</span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Heure"</span>,</span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">350</span>,</span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">700</span></span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir correctement toutes les dates en datetime</span></span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.to_datetime(spl.columns)</span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer des labels formatés</span></span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>dates_str <span class="op">=</span> [d.strftime(<span class="st">'%m-</span><span class="sc">%d</span><span class="st">'</span>) <span class="cf">for</span> d <span class="kw">in</span> dates]</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir les ticks avec un step</span></span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a>step <span class="op">=</span> <span class="dv">5</span>  <span class="co"># par exemple un tick tous les 10 jours</span></span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(</span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a>    tickmode<span class="op">=</span><span class="st">'array'</span>,</span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a>    tickvals<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(dates), step)),  <span class="co"># positions</span></span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a>    ticktext<span class="op">=</span>[dates_str[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(dates), step)]</span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a>::: {#heatmap2}</span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ephem</span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytz</span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"iframe"</span></span>
<span id="cb1-805"><a href="#cb1-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-806"><a href="#cb1-806" aria-hidden="true" tabindex="-1"></a>local_tz <span class="op">=</span> pytz.timezone(<span class="st">"Europe/Paris"</span>)</span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Paramètres ----</span></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a>base_folder_spl <span class="op">=</span> <span class="st">"data/SPL"</span></span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a>meteo_path <span class="op">=</span> <span class="vs">r"data/meteo/Rncfs_Belledonne_Meteo_2025_simplifie</span><span class="dv">.</span><span class="vs">xlsx"</span></span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a>latitude <span class="op">=</span> <span class="fl">45.109984180407984</span></span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a>longitude <span class="op">=</span> <span class="fl">6.11257375591396</span></span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Fonction lever/coucher soleil ----</span></span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heures_lever_coucher_soleil(latitude, longitude, date):</span>
<span id="cb1-817"><a href="#cb1-817" aria-hidden="true" tabindex="-1"></a>    lieu <span class="op">=</span> ephem.Observer()</span>
<span id="cb1-818"><a href="#cb1-818" aria-hidden="true" tabindex="-1"></a>    lieu.lat <span class="op">=</span> <span class="bu">str</span>(latitude)</span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a>    lieu.lon <span class="op">=</span> <span class="bu">str</span>(longitude)</span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a>    lieu.date <span class="op">=</span> date</span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a>    lever_soleil <span class="op">=</span> lieu.next_rising(ephem.Sun()).datetime()</span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a>    coucher_soleil <span class="op">=</span> lieu.next_setting(ephem.Sun()).datetime()</span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a>    lever_soleil <span class="op">=</span> lever_soleil.replace(tzinfo<span class="op">=</span>pytz.utc).astimezone(local_tz)</span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a>    coucher_soleil <span class="op">=</span> coucher_soleil.replace(tzinfo<span class="op">=</span>pytz.utc).astimezone(local_tz)</span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lever_soleil, coucher_soleil</span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Lister les enregistreurs dynamiquement ----</span></span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a>enregistreurs <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(base_folder_spl) <span class="cf">if</span> os.path.isdir(os.path.join(base_folder_spl, f))]</span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a>enregistreurs.sort()  <span class="co"># Tri alphabétique</span></span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Charger météo ----</span></span>
<span id="cb1-832"><a href="#cb1-832" aria-hidden="true" tabindex="-1"></a>df_p <span class="op">=</span> pd.read_excel(meteo_path)</span>
<span id="cb1-833"><a href="#cb1-833" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'timestamp'</span>] <span class="op">=</span> pd.to_datetime(df_p[<span class="st">'TIMESTAMP'</span>], utc<span class="op">=</span><span class="va">True</span>)  <span class="co"># UTC</span></span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'timestamp'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.tz_convert(<span class="st">'Europe/Paris'</span>)  <span class="co"># Conversion en heure locale</span></span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'time'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.time</span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'date'</span>] <span class="op">=</span> df_p[<span class="st">'timestamp'</span>].dt.date</span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a>df_p <span class="op">=</span> df_p[df_p[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> t: t.minute <span class="kw">in</span> [<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">40</span>])]  <span class="co"># 15 min step</span></span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'time_str'</span>] <span class="op">=</span> df_p[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.strftime(<span class="st">'%H:%M'</span>))</span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'Rain'</span>] <span class="op">=</span> pd.to_numeric(df_p[<span class="st">'précipitation'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a>df_p[<span class="st">'Rain_binary'</span>] <span class="op">=</span> df_p[<span class="st">'Rain'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-842"><a href="#cb1-842" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Préparer les heatmaps pour chaque enregistreur ----</span></span>
<span id="cb1-843"><a href="#cb1-843" aria-hidden="true" tabindex="-1"></a>heatmaps <span class="op">=</span> {}</span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> enreg <span class="kw">in</span> enregistreurs:</span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a>    folder_spl <span class="op">=</span> os.path.join(base_folder_spl, enreg)</span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a>    spl_file <span class="op">=</span> os.path.join(folder_spl, <span class="st">'db_spl.pkl'</span>)</span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(spl_file):</span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(spl_file, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a>        df_spl <span class="op">=</span> pickle.load(f)</span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'date'</span>] <span class="op">=</span> df_spl.index.date</span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'time'</span>] <span class="op">=</span> df_spl.index.time</span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'time_str'</span>] <span class="op">=</span> df_spl[<span class="st">'time'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.strftime(<span class="st">'%H:%M'</span>))</span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a>    selected_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df_spl.columns <span class="cf">if</span> <span class="bu">any</span>(<span class="bu">str</span>(i) <span class="kw">in</span> col <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>,<span class="dv">43</span>))]</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a>    df_spl[<span class="st">'avg_spl'</span>] <span class="op">=</span> df_spl[selected_columns].mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a>    heatmap_data <span class="op">=</span> df_spl.pivot_table(</span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a>        values<span class="op">=</span><span class="st">'avg_spl'</span>,</span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span><span class="st">'time_str'</span>,</span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span><span class="st">'date'</span>,</span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a>        aggfunc<span class="op">=</span><span class="st">'mean'</span></span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a>    df_met <span class="op">=</span> df_p[df_p[<span class="st">'date'</span>].isin(heatmap_data.columns)]</span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a>    heatmap_rain <span class="op">=</span> df_met.pivot_table(</span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a>        values<span class="op">=</span><span class="st">'Rain_binary'</span>,</span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span><span class="st">'time_str'</span>,</span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span><span class="st">'date'</span>,</span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a>        aggfunc<span class="op">=</span><span class="st">'max'</span>,</span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a>        fill_value<span class="op">=</span><span class="dv">0</span></span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a>    heatmap_rain <span class="op">=</span> heatmap_rain.reindex(index<span class="op">=</span>heatmap_data.index, columns<span class="op">=</span>pd.to_datetime(heatmap_data.columns), fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a>    rain_mask <span class="op">=</span> heatmap_rain <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a>    heatmaps[enreg] <span class="op">=</span> {<span class="st">'spl'</span>: heatmap_data, <span class="st">'rain_mask'</span>: rain_mask}</span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Construire figure Plotly ----</span></span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, enreg <span class="kw">in</span> <span class="bu">enumerate</span>(enregistreurs):</span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> heatmaps.get(enreg)</span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a>    spl <span class="op">=</span> data[<span class="st">'spl'</span>]</span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> data[<span class="st">'rain_mask'</span>]</span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a>    z_spl <span class="op">=</span> spl.values.copy()</span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a>    z_spl[mask.values] <span class="op">=</span> np.nan</span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a>    trace_spl <span class="op">=</span> go.Heatmap(</span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a>        z<span class="op">=</span>z_spl,</span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(spl.columns))),</span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>spl.index,</span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'Purples'</span>,</span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a>        zmin<span class="op">=</span><span class="dv">25</span>, zmax<span class="op">=</span><span class="dv">60</span>,</span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a>        showscale<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span>(i<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a>    z_rain <span class="op">=</span> spl.values.copy()</span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a>    z_rain[<span class="op">~</span>mask.values] <span class="op">=</span> np.nan</span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a>    trace_rain <span class="op">=</span> go.Heatmap(</span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a>        z<span class="op">=</span>z_rain,</span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(spl.columns))),</span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>spl.index,</span>
<span id="cb1-905"><a href="#cb1-905" aria-hidden="true" tabindex="-1"></a>        colorscale<span class="op">=</span><span class="st">'Greens'</span>,</span>
<span id="cb1-906"><a href="#cb1-906" aria-hidden="true" tabindex="-1"></a>        showscale<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a>        visible<span class="op">=</span>(i<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace_spl)</span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(trace_rain)</span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Dropdown ----</span></span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a>buttons <span class="op">=</span> []</span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, enreg <span class="kw">in</span> <span class="bu">enumerate</span>(enregistreurs):</span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a>    vis <span class="op">=</span> [<span class="va">False</span>]<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span><span class="bu">len</span>(enregistreurs))</span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a>    vis[<span class="dv">2</span><span class="op">*</span>i] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a>    vis[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a>    buttons.append(<span class="bu">dict</span>(label<span class="op">=</span>enreg,</span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a>                        method<span class="op">=</span><span class="st">'update'</span>,</span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a>                        args<span class="op">=</span>[{<span class="st">'visible'</span>: vis},</span>
<span id="cb1-922"><a href="#cb1-922" aria-hidden="true" tabindex="-1"></a>                              {<span class="st">'title'</span>:<span class="ss">f"Heatmap SPL 2025 – </span><span class="sc">{</span>enreg<span class="sc">}</span><span class="ss">"</span>}]))</span>
<span id="cb1-923"><a href="#cb1-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-924"><a href="#cb1-924" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb1-925"><a href="#cb1-925" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>[<span class="bu">dict</span>(buttons<span class="op">=</span>buttons, x<span class="op">=</span><span class="fl">0.0</span>, y<span class="op">=</span><span class="fl">1.15</span>, xanchor<span class="op">=</span><span class="st">'left'</span>, yanchor<span class="op">=</span><span class="st">'top'</span>)],</span>
<span id="cb1-926"><a href="#cb1-926" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title=f"Heatmap SPL 2025 – {enregistreurs[0]}",</span></span>
<span id="cb1-927"><a href="#cb1-927" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Date"</span>,</span>
<span id="cb1-928"><a href="#cb1-928" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Heure"</span>,</span>
<span id="cb1-929"><a href="#cb1-929" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">350</span>,</span>
<span id="cb1-930"><a href="#cb1-930" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">700</span></span>
<span id="cb1-931"><a href="#cb1-931" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-932"><a href="#cb1-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir correctement toutes les dates en datetime</span></span>
<span id="cb1-933"><a href="#cb1-933" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.to_datetime(spl.columns)</span>
<span id="cb1-934"><a href="#cb1-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-935"><a href="#cb1-935" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer des labels formatés</span></span>
<span id="cb1-936"><a href="#cb1-936" aria-hidden="true" tabindex="-1"></a>dates_str <span class="op">=</span> [d.strftime(<span class="st">'%m-</span><span class="sc">%d</span><span class="st">'</span>) <span class="cf">for</span> d <span class="kw">in</span> dates]</span>
<span id="cb1-937"><a href="#cb1-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-938"><a href="#cb1-938" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir les ticks avec un step</span></span>
<span id="cb1-939"><a href="#cb1-939" aria-hidden="true" tabindex="-1"></a>step <span class="op">=</span> <span class="dv">5</span>  <span class="co"># par exemple un tick tous les 10 jours</span></span>
<span id="cb1-940"><a href="#cb1-940" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(</span>
<span id="cb1-941"><a href="#cb1-941" aria-hidden="true" tabindex="-1"></a>    tickmode<span class="op">=</span><span class="st">'array'</span>,</span>
<span id="cb1-942"><a href="#cb1-942" aria-hidden="true" tabindex="-1"></a>    tickvals<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(dates), step)),  <span class="co"># positions</span></span>
<span id="cb1-943"><a href="#cb1-943" aria-hidden="true" tabindex="-1"></a>    ticktext<span class="op">=</span>[dates_str[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(dates), step)]</span>
<span id="cb1-944"><a href="#cb1-944" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-945"><a href="#cb1-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-946"><a href="#cb1-946" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb1-947"><a href="#cb1-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-948"><a href="#cb1-948" aria-hidden="true" tabindex="-1"></a>Figure 6 : Heatmap avec bruit insecte en mauve et bruit de la pluie en vert</span>
<span id="cb1-949"><a href="#cb1-949" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb1-950"><a href="#cb1-950" aria-hidden="true" tabindex="-1"></a>::: {#photo-map}</span>
<span id="cb1-951"><a href="#cb1-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-954"><a href="#cb1-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-955"><a href="#cb1-955" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-956"><a href="#cb1-956" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb1-957"><a href="#cb1-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-958"><a href="#cb1-958" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> mpimg.imread(<span class="vs">r"data</span><span class="er">\</span><span class="vs">image</span><span class="ch">\a</span><span class="vs">udiomoth</span><span class="dv">.</span><span class="vs">png"</span>)</span>
<span id="cb1-959"><a href="#cb1-959" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb1-960"><a href="#cb1-960" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb1-961"><a href="#cb1-961" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)  <span class="co"># enlève les axes</span></span>
<span id="cb1-962"><a href="#cb1-962" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb1-963"><a href="#cb1-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-964"><a href="#cb1-964" aria-hidden="true" tabindex="-1"></a>Figure 7 : Photo de la map avec les noms des enregistreurs</span>
<span id="cb1-965"><a href="#cb1-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-966"><a href="#cb1-966" aria-hidden="true" tabindex="-1"></a>::: </span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>
